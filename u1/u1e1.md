# Tema 5. T√©cnicas para mejorar la estructura y robustez de c√≥digo

## Unidad 1. Gesti√≥n de errores y excepciones

## Ejercicio 5.1.1 (Castellano)

En este ejercicio vamos a trabajar con la generaci√≥n de errores y excepciones, aunque ya los hayamos visto de pasada al trabajar con clases en el caso de las clases abstractas, por ejemplo.

Para ello vamos a realizar un ejercicio partiendo de un inventario que tienes en el c√≥digo de partida del ejercicio.
Este inventario contiene una serie de productos en un array de objetos, cada uno de los cuales representa un producto y tienen la siguiente estructura com√∫n:

```js
{
    code: 156,
    name: 'Black',
    price: 88.99,
    discount: 9,
    amount: 50
},
```

Las caracter√≠sticas de este inventario es que:

- No puede tener productos con el mismo `code`.
- No puede tener productos con el mismo `name`.
- No puede tener productos con un precio inferior a `50`.
- No puede tener descuentos inferiores a `0` o superiores a `10`.
- No puede tener una cantidad negativa.


### A. Clase `IventoryManager`

Se ha de implementar una clase `InventoryManager` que ha de contar con:

- Una propiedad privada `productList` que contendr√° la lista de productos.

- Un m√©todo `init` que recibe como √∫nico par√°metro `products` que contiene la lista de productos inicial.

- Un m√©todo `validateProduct` que recibe como par√°metro un producto y valida que cumpla todos los requisitos indicados anteriormente.

- Un m√©todo `addProduct` que recibe un producto y valide que disponga de todos los datos y cumpla los requisitos anteriores antes de ser a√±adido a la `productList`


Adicionalmente:


### B. M√©todo `init`

Este m√©todo es el encargado de importar (agregando cada uno mediante el m√©todo `addProduct`) los diferentes productos que reciba en el par√°metro `products` a la `productList`.

Adem√°s ha de gestionar los problemas que puedan producirse en ese proceso, de tal forma que al final de toda la importaci√≥n:

- Devuelva `true` si todos los productos se importaron correctamente sin problemas.

- Devuelva una `array` con la lista de los problemas encontrados por cada producto problem√°tico.


### C. M√©todo `nProducts`

Este m√©todo simplemente devolver√° la cantidad de productos contenidos en la `productList`.


### D. M√©todo `validateProduct`

Este m√©todo es el encargado de validar un producto para decidir si se a√±ade o no a la `productList`.

> üí° **NOTA.** Para ello ha de implementar la siguiente funcionalidad (ten en cuenta que puedes dividir la funcionalidad requerida en otros m√©todos privados de la clase para organizar mejor el c√≥digo si lo deseas):

La forma y orden en la que se debe llevar a cabo la validaci√≥n es la siguiente:

- Si alguna de las propiedades est√° vac√≠a o no es del tipo requerido (`code`, `discount` y `amount` un n√∫mero entero no negativo, `name` un **string** no vac√≠o y `price` un n√∫mero positivo flotante con m√°ximo 2 decimales) lanza el siguiente error:

```
ERROR_DATA. Alguno de los datos del producto ([code]) no tiene un formato v√°lido.
```

- Si el c√≥digo del producto a a√±adir ya se encuentra en la lista de productos, lanzar√° el error siguiente:

```
INVENTORY_CODE. Ya existe otro producto con ese c√≥digo ([code]).
```

- Si la lista de productos ya cuenta con un producto que tenga el mismo nombre del producto a a√±adir, lanzar√° el siguiente error:

```
INVENTORY_NAME. El nombre del producto ([code]) ya existe.
```

- Si el producto a a√±adir tiene un precio inferior a 50, lanza el error siguiente:

```
INVENTORY_PRICE. El precio del producto ([code]) no puede ser inferior a 50.
```

- Si el producto a a√±adir tiene un descuento que no se encuentre entre 0 y 10, lanzar√° el siguiente error:

```
INVENTORY_DISCOUNT. El descuento del producto ([code]) debe estar entre 0 y 10.
```

- Si el producto a a√±adir tiene una cantidad negativa, genere el error siguiente:

```
INVENTORY_AMOUNT. La cantidad de producto ([code]) no puede ser inferior a 10.
```

- Si por el contrario, el producto es totalmente v√°lido el m√©todo retorna `true`.



### E. M√©todo `addProduct`

Este m√©todo se encarga de a√±adir un producto al inventario, por lo que recibe como √∫nico par√°metro `product` que es un objeto con la estructura ya comentada, implementando la siguiente funcionalidad:

- Valida el producto mediante el m√©todo `validateProduct`.

- Si es v√°lido, lo a√±ade a la `productList`.

- Si no es v√°lido, recoge el error generado por `validateProduct`.

- Tanto si es v√°lido como si no (uso de `finally`) retorna un objeto con esta estructura:

```js
{
    status: [true | false]
    message: [mensaje_resultado]
}
```

Donde:

- `status`: [true | false]: representa un **booleano** en funci√≥n de si se pudo a√±adir el producto o no.

- `message`: [mensaje_resultado]: es un **string** que en caso de error contiene el error recibido por el m√©todo `validateProduct` y en caso de √©xito contendr√° la cadena `INVENTORY_ADD. El producto ([code]) ha sido a√±adido con √©xito al inventario.`


> üí° NOTA: Ten en cuenta que siempre que veas `[code]` ha de ser sustituido por el valor del c√≥digo del producto en cuesti√≥n.<br>


Por ejemplo, para un producto con c√≥digo `152` algunos mensajes ser√≠an:

```
INVENTORY_NAME. El nombre del producto (152) ya existe.

INVENTORY_AMOUNT. La cantidad de producto (152) no puede ser negativa.

INVENTORY_ADD. El producto (152) ha sido a√±adido con √©xito al inventario.
```


### F. Exportaci√≥n de clase

Exporta la clase `IventoryManager` para poder ser usada en otros m√≥dulos.


-----


# Tema 5. T√®cniques per millorar l'estructura i la robustesa de codi

## Unitat 1. Gesti√≥ d'errors i excepcions

## Exercici 5.1.1 (Catal√†)

En aquest exercici treballarem amb la generaci√≥ d'errors i excepcions, encara que ja els h√†gim vist de passada en treballar amb classes en el cas de les classes abstractes, per exemple.

Per fer-ho, farem un exercici partint d'un inventari que tens al codi de partida de l'exercici.
Aquest inventari cont√© una s√®rie de productes en un array d'objectes, cadascun dels quals representa un producte i tenen la seg√ºent estructura comuna:

```js
{
     code: 156,
     name: 'Black',
     price: 88.99,
     discount: 9,
     amount: 50
},
```

Les caracter√≠stiques daquest inventari √©s que:

- No pot tenir productes amb el mateix `code`.
- No podeu tenir productes amb el mateix `name`.
- No pot tindre productes amb un preu inferior a `50`.
- No podeu tenir descomptes inferiors a `0` o superiors a `10`.
- No pot tindre una quantitat negativa.


### A. Classe `IventoryManager`

S'ha d'implementar una classe `InventoryManager` que ha de comptar amb:

- Una propietat privada `productList` que contindr√† la llista de productes.

- Un m√®tode `init` que rep com a √∫nic par√†metre `products` que cont√© la llista de productes inicial.

- Un m√®tode `validateProduct` que rep com a par√†metre un producte i valida que compleixi tots els requisits indicats anteriorment.

- Un m√®tode `addProduct` que rep un producte i validi que disposi de totes les dades i compleixi els requisits anteriors abans de ser afegit a la `productList`


Addicionalment:


### B. M√®tode `init`

Aquest m√®tode √©s l'encarregat d'importar (afegint cadasc√∫ mitjan√ßant el m√®tode `addProduct`) els diferents productes que rebi al par√†metre `products` a la `productList`.

A m√©s, ha de gestionar els problemes que es puguin produir en aquest proc√©s, de manera que al final de tota la importaci√≥:

- Torneu `true` si tots els productes es van importar correctament sense problemes.

- Torneu una `array` amb la llista dels problemes trobats per cada producte problem√†tic.


### C. M√®tode `nProducts`

Aquest m√®tode simplement tornar√† la quantitat de productes continguts a la `productList`.


### D. M√®tode `validateProduct`

Aquest m√®tode √©s l'encarregat de validar un producte per decidir si s'afegeix a la `productList` o no.

> üí° **NOTA.** Per aix√≤ ha d'implementar la funcionalitat seg√ºent (tingues en compte que pots dividir la funcionalitat requerida en altres m√®todes privats de la classe per organitzar millor el codi si ho desitges):

La forma i ordre en qu√® s'ha de dur a terme la validaci√≥ √©s la seg√ºent:

- Si alguna de les propietats est√† buida o no √©s del tipus requerit (`code`, `discount` i `amount` un nombre enter no negatiu, `name` un **string** no buit i `price` un nombre positiu flotant amb m√†xim 2 decimals) llan√ßa el seg√ºent error:

```
ERROR_DATA. Alguna de les dades del producte ([code]) no t√© un format v√†lid.
```

- Si el codi del producte a afegir ja √©s a la llista de productes, llan√ßar√† l'error seg√ºent:

```
INVENTORY_CODE. Ja existeix un altre producte amb aquest codi ([code]).
```

- Si la llista de productes ja compta amb un producte que tingui el mateix nom del producte a afegir, llan√ßar√† el seg√ºent error:

```
INVENTORY_NAME. El nom del producte ([code]) ja existeix.
```

- Si el producte a afegir t√© un preu inferior a 50, llen√ßa l'error seg√ºent:

```
INVENTORY_PRICE. El preu del producte ([code]) no pot ser inferior a 50.
```

- Si el producte a afegir t√© un descompte que no estigui entre 0 i 10, llan√ßar√† el seg√ºent error:

```
INVENTORY_DISCOUNT. El descompte del producte ([code]) ha d'estar entre 0 i 10.
```

- Si el producte a afegir t√© una quantitat negativa, genereu l'error seg√ºent:

```
INVENTORY_AMOUNT. La quantitat de producte ([code]) no pot ser inferior a 10.
```

- Si per contra, el producte √©s totalment v√†lid el m√®tode retorna `true`.



### E. M√®tode `addProduct`

Aquest m√®tode s'encarrega d'afegir un producte a l'inventari, per la qual cosa rep com a √∫nic par√†metre `product` que √©s un objecte amb l'estructura ja comentada, implementant la funcionalitat seg√ºent:

- Valida el producte mitjan√ßant el m√®tode `validateProduct`.

- Si √©s v√†lid, ho afegeix a la `productList`.

- Si no √©s v√†lid, recull l'error generat per `validateProduct`.

- Tant si √©s v√†lid com si no (√∫s de `finally`) retorna un objecte amb aquesta estructura:

```js
{
     estatus: [true | false]
     message: [missatge_resultat]
}
```

On:

- `status`: [true | false]: representa un **boole√†** en funci√≥ de si es va poder afegir el producte o no.

- `message`: [missatge_resultat]: √©s un **string** que en cas d'error cont√© l'error rebut pel m√®tode `validateProduct` i en cas d'√®xit contindr√† la cadena `INVENTORY_ADD. El producte ([code]) ha estat afegit amb √®xit a l'inventari.`


> üí° NOTA: Tingues en compte que sempre que vegis `[code]` ha de ser substitu√Øt pel valor del codi del producte en q√ºesti√≥.<br>


Per exemple, per a un producte amb codi `152` alguns missatges serien:

```
INVENTORY_NAME. El nom del producte (152) ja existeix.

INVENTORY_AMOUNT. La quantitat de producte (152) no pot ser negativa.

INVENTORY_ADD. El producte (152) ha estat afegit amb √®xit a l'inventari.
```


### F. Exportaci√≥ de classe

Exporta la classe `IventoryManager` per poder ser utilitzada en altres m√≤duls.
